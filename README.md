# Overview
The phone book is a parent resource to easily reference students, staff, and
the PTA board and committee chairs. The school district provides most of the
data and the person compiling the phone book is responsible for coordinating
and putting it all together.

The phone book is produced using the following:

- Data from the school:
  - Class lists
  - Student and guardian data
  - Staff list

- Data from the PTA:
  - PTA Board list
  - Committe information

- Student Artwork

This document will walk through the steps needed to compile the phone book.

# Process

## Overview
1. Contact staff at the school about the data and student artwork
2. Compile the data
3. Process student artwork
4. Compile the unified phone book including artwork and all data
5. Send the phone book to the Membership committee for distribution

## Contact Staff
Early in the school year:
  - Reach out to the office secretary, Mrs. Valdivia, to ask for the staff list,
    class lists, and the parent information collected at registration.
  - Reach out to the art teacher, Mrs. Hoganson, about having her start the cover
    artwork contest.

## Compile the data

### Preparation
1. Create a new folder in the shared drive under Phone Book for the new school year
2. Copy the manually formatted worksheets into a single new workbook:
   - Staff
   - PTA

### Data Format

#### Staff
The staff list format is not a standard report which is why it must be manually
formatted. Take this file and map the data to the new workbook copied above.
There is a `staff.py` file which can parse the data and spit out formatted
emails.

#### Class Lists

The class lists are manually generated by the school and contain the teacher,
grade, room number, and the list of students. For 2025-2026, the file layout
looked like this:

| Teacher: LAST_NAME | GRADE | ROOM # 210 |
| ------------------ | ----- | ---------- |
|                    |       |            |
| STUDENT NAME       |       |            |
| ADAMS, JOE         |       |            |
| DOE, JANE          |       |            |
| SMITH, MARK        |       |            |

For example:

| Teacher: Washington, George | 5   | ROOM # 1776 |
| --------------------------- | --- | ----------- |
|                             |     |             |
| STUDENT NAME                |     |             |
| ADAMS, BETSY                |     |             |
| ADAMS, JOHN                 |     |             |
| JEFFERSON, THOMAS           |     |             |

> :memo: The names in this list may be the child's preferred name and not their
> legal name found in the student and guardian data.

#### Student and Guardian Data

This data is generated via a report and is delivered in three separate files
based upon the contact information the guardian wishes to provide:

1. Name and email
2. Name, email, and phone
3. Name, email, phone, and address

> :memo: The selection seems to be unique to each student. The guardian may
> potentially select different values for each of their students.

The file format in 2025-2026 looked like this:

| Full name (LF) | Grade | Homeroom Teacher | Info to Share | Guardian Name | Email |
| -------------- | ----- | ---------------- | ------------- | ------------- | ----- |
| LAST, FIRST    | GRADE | FIRST LAST       | INFO          | FIRST LAST    | EMAIL |

- The Info to share column was text describing what data to share and was the
  same across each file.
- The email addresses were sometimes all lowercase, sometimes all uppercase.
- Note that the teacher name format differs between this last and the class
  list.

### Generate the skeleton

This can be done manually. That sounds painful. The included script in this
repository will use the data documents to produce an Excel file containing the
skeleton of the phone book.

If the data files were distributed as Google Sheet documents, download them to
your machine. Run the python import script such as below:

```python
python3 import.py \
  --parent-files ~/dev/personal/pta-phonebook/files/PTA\ Directory\ [123]*.xlsx \
  --class-list ~/dev/personal/pta-phonebook/files/PTA\ CLASS\ LISTS\ 25-26.xlsx \
  --output output.xlsx
```

This process will warn if any students are found in the student and guardian
files and not listed in the class list. This likely indicates a non-legal name
is used in the class lists. Update the appropriate data file so the data is
merged properly.

Spot check the Excel file to ensure it looks correct.

### Format the data

1. Take the generated skeleton file and upload it to Google Sheets.
2. Name the file WHS PTA Phone Book 20XX-20YY with the correct years
3. Update the class column widths
   - When Google Sheets converts from Excel to Google Sheets it does not respect
     the column width. Change column B to width 128 pixels and column D to 250.
     I recorded a macro while doing this and ran it across all the class worksheets.
4. Copy the Staff and PTA worksheets you had generated into this new sheet
5. Spot check the worksheets to ensure they are accurate

### Produce a PDF

1. From the Google Sheets file, run File -> Download -> PDF
   - Set the margins at 0.25" on all sides
   - Ensure the whole workbook is selected
2. Ensure that none of the pages overflow. If so, adjust the pages as necessary.
3. Download the file to your local machine.

## Student Artwork

1. Once you have the student artwork, you need to do the hard part: select four
   pieces to be in the book. There will be a front cover, front inside cover,
   back inside cover, and back cover.

2. Scan the documents at 300 DPI. Place them in the `covers/originals` folder
   with the following names:
   - front-cover.jpg
   - front-inside-cover.jpg
   - back-inside-cover.jpg
   - back-cover.jpg

   The script is expecting these specific names.

3. Copy the `covers/originals` folder to `covers/modified`. In case of issues,
   copy the originals over the modified versions again.
4. Use image editing software such as GIMP or similar to ensure the borders are
   white and consistent (optional).
5. Run `resize.sh` to resize the images to 2480x3508 px and set an appropriate
   file quality for the desired file size. This will write the images to
   `covers`.

## Compile the whole book
- Install img2pdf and pdfunite if necessary
- Run the build script like this:
  ```bash
  bash build.sh \
    "/path/to/the/download/file/above/WHS PTA Phone Book 2025-2026.pdf" \
    "WHS PTA Phone Book 2025-2026.pdf"
  ```

This will combine the artwork with the downloaded PDF into the final file.

# Review and Distribution
Review the resulting file to ensure it is accurate. Check for glaring errors
and have a second set of eyes look it over.

Once ready, send it to the Membership committee chairperson to distribute to
the PTA members.

For the students, Mr. Hoganson owns Graphic Arts Services and prints four
copies to give to the cover artwork contest winners. Mrs. Hoganson distributes
those to the students.
